define("launchpad/lib/contacts/contacts-model",["jquery","angular","launchpad/lib/common/util","launchpad/lib/contacts/contacts-module"],function(g,h,k,l){l.factory("ContactsModel",["$rootScope","orderByFilter","httpService",function(c,g,f){c=function(b){this.locale=b.locale;this.contactsListService=f.getInstance({endpoint:b.contacts});b.contactData&&(this.contactDataServiceEndpoint=b.contactData);b.contactDetails&&(this.contactDetailsServiceEndpoint=b.contactDetails,this.contactDetailsData=[]);b.metaData&&
(this.metaDataEndpoint=b.metaData);this.contacts=[];!0!==b.lazyload&&this.loadContacts()};c.prototype.loadContacts=function(){var b=this,a=b.contactsListService.read();b.loading=!0;a.success(function(a){b.contacts=a&&"null"!==a?b.preprocessContacts(a):[]});a.error(function(a){b.error={message:a.statusText}});a["finally"](function(){b.loading=!1});return a};c.prototype.loadContactDetails=function(b){var a=this;0<a.contactDetailsData.length&&h.forEach(a.contactDetailsData,function(d){d&&d.id===b&&(a.currentDetails=
d,a.detailsLoaded=!0)});if(a.detailsLoaded)a.detailsLoaded=!1;else{this.contactDetailsService=f.getInstance({endpoint:this.contactDetailsServiceEndpoint,urlVars:{contactId:b}});var e=a.contactDetailsService.read();a.loading=!0;e.success(function(b){a.currentDetails=b;a.contactDetailsData.push(a.currentDetails)});e.error(function(b){a.error={message:b.statusText}});e["finally"](function(){a.loading=!1});return e}};c.prototype.preprocessContacts=function(b){var a=[];return a=g(b,"name")};c.prototype.createContact=
function(b){if(!b)return!1;var a=this;b=a.currentContact.id;a.currentContact.photoUrl=k.getDefaultProfileImage(a.currentContact.name,77,77);a.contactDataService=f.getInstance({endpoint:this.contactDataServiceEndpoint,urlVars:{contactId:b}});a.contactDetailsService=f.getInstance({endpoint:this.contactDetailsServiceEndpoint,urlVars:{contactId:b}});b=a.contactDataService.create({data:a.currentContact});var e=a.contactDetailsService.create({data:a.currentDetails});a.sendXhrRequest(b);return a.sendXhrRequest(e,
function(){a.contacts.push(a.currentContact);a.contactDetailsData.push(a.currentDetails);a.refreshModel()})};c.prototype.updateContact=function(b){if(!b)return!1;var a=this,e=a.currentContact.id;b=function(a,b){var d={};h.forEach(b,function(b,c){a.forEach(function(a){a===c&&(d[c]=b)})});return d};a.contactDataService=f.getInstance({endpoint:a.contactDataServiceEndpoint,urlVars:{contactId:e}});void 0===a.currentContact.photoUrl&&(a.currentContact.photoUrl=k.getDefaultProfileImage(a.currentContact.name,
77,77));var d=b(["name","id","photoUrl","partyId","account"],a.currentContact),d=a.contactDataService.update({data:d});a.sendXhrRequest(d,function(){a.contacts[a.index]=a.currentContact;a.refreshModel()});a.contactDetailsService=f.getInstance({endpoint:a.contactDetailsServiceEndpoint,urlVars:{contactId:e}});var d="address city state dateOfBirth email phone id".split(" "),c=b(d,a.currentDetails);b=function(a,b){a.forEach(function(a){b[a]||(b[a]=null)});return b}(d,c);b=a.contactDetailsService.update({data:b});
return a.sendXhrRequest(b,function(){0<a.contactDetailsData.length&&h.forEach(a.contactDetailsData,function(b){b&&b.id===e&&(b=c,a.currentDetails=b)})})};c.prototype.deleteContact=function(){var b=this,a=b.currentContact.id;b.contactDataService=f.getInstance({endpoint:b.contactDataServiceEndpoint,urlVars:{contactId:a}});var c=b.contactDataService.del({data:null});b.sendXhrRequest(c,function(a){h.forEach(b.contacts,function(c){c.id===a&&(c=b.contacts.indexOf(c),b.contacts.splice(c,1))});0<b.contacts.length?
b.currentContact=b.contacts[0]:(b.currentContact=null,b.moduleState="contactsNone");b.refreshModel()}(a))};c.prototype.noContactsFound=function(){return!this.loading&&0===this.contacts.length};c.prototype.sendXhrRequest=function(b,a){var c=this;b.loading=!0;b.success(function(b){a&&a()});b.error(function(a){c.error={message:a.statusText}});b["finally"](function(){b.loading=!1});return b};c.prototype.selectContact=function(b){b&&!this.disableSelection&&(0<this.contacts.length?(this.selected=b.id,this.currentContact=
b,this.idx=this.contacts.indexOf(this.currentContact),this.loadContactDetails(this.currentContact.id)):(this.currentContact=null,this.moduleState="contactsNone"))};c.prototype.refreshModel=function(b){this.disableSelection=!1;this.currentContact&&(this.selectContact(this.currentContact),this.moduleState="contactsView")};c.prototype.findByName=function(b){for(var a=0,c=this.contacts.length;a<c;a++){var d=this.contacts[a];if(d.name===b)return d}};return c}])});define("launchpad/lib/contacts/contacts-module",["angular","launchpad/lib/common"],function(g){return g.module("contacts",["common"])});define(["launchpad/lib/contacts/contacts-module","launchpad/lib/contacts/contacts-model"],function(g){return g});
//# sourceMappingURL=contacts.js.map